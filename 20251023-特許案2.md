【発明の名称】

通信帯域・GPU・CPUを統合制御する合成データ生成のパイプライン並列化装置、方法およびプログラム

【背景技術】（要旨レベル）

合成データ生成サーバでは、入力データの取得および生成結果の送信に伴うネットワークI/Oがボトルネック化し、GPUやCPUのアイドル時間が発生する。従来のスケジューリングは計算資源（GPU/CPU）中心であり、通信帯域を同時最適化できず、パイプライン全体のクリティカルパス短縮に限界があった。

【課題】

外部ストレージ／クラウドとのデータ転送（ダウンロード／アップロード）を伴う合成データ生成パイプラインにおいて、通信帯域状況・GPUのVRAM等使用状況・CPUのアイドル状況を同時に考慮しつつ、タスク依存関係に基づく動的再スケジューリングにより、全体のクリティカルパスを短縮し、スループットを最大化する。

【解決手段】（要旨）

本装置は、(i) ネットワークI/O監視部（帯域使用率、遅延、スループットを取得）、(ii) タスク依存グラフ管理部（通信ノード・GPUノード・CPUノードを含む拡張DAGを保持）、(iii) 実行時間予測部（通信・GPU・CPUの処理時間を学習／統計で推定）、(iv) 統合スケジューラ（予測と実測を用いてキュー順序・並列度をリアルタイム更新）を備える。
スケジューラは、通信帯域の混雑やGPUのVRAM不足またはI/O待ち検出時に、通信完了待ちのないCPUタスクの割込投入、事前プリフェッチ／結果アップロードの前倒し、データ圧縮／解凍と計算のオーバーラップ、および通信ノードを含むクリティカルパス最短化を行う。これにより、GPU/CPU/ネットワークの三層を統合した動的パイプライン最適化が実現する。

【発明の効果】

本発明によれば、ネットワークI/Oが支配的な合成データ生成ワークロードにおいても、通信帯域と演算資源を同時最適化することが可能となる。これにより、GPUの待機時間を削減し、CPU・GPU・ネットワークの全リソースを均衡的に活用できるため、従来方式に比べパイプライン全体のスループットを最大化できる。また、クラウド環境や分散サーバ環境にも適用可能であり、異種GPU構成下でも自律的に最適スケジュールを導出する。

【実施形態】

一実施形態では、スケジューラはタスクグラフ（DAG: Directed Acyclic Graph）として定義された合成データ生成パイプラインを解析し、ノードごとに通信コスト・計算コストを推定する。これに基づき、優先度付きキューにより実行順序を決定し、通信帯域監視モジュールからの情報を用いて転送タイミングを調整する。GPUメモリ圧迫時にはCPU側での一時的前処理を優先させるなど、リソース間の動的な負荷分散を実現する。また、各処理ステージ間ではリングバッファを用いたストリーム転送により、逐次的なI/O待機を解消する。

さらに、ログ収集および性能トレース機能を備え、過去の実行履歴に基づくヒューリスティック最適化や機械学習ベースのスケジューリングも可能である。